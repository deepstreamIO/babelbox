/*! babelbox 0.0.2 (c)2015 @licence MIT*/
!function(a,b){"function"==typeof define&&define.amd?define(function(){return b}):"object"==typeof exports?module.exports=b:a.babelbox=b}(this,function(){function a(a,c){var d=b(a);if(null!==d)for(var e in c)d=d.replace("[["+e+"]]",c[e]);return d}function b(a){return e(a.split(l.SPLIT_CHAR),null,m,0)}function c(a,b){for(var c in a)d(c.split(l.SPLIT_CHAR),a[c],m,0,b,o,l.SPLIT_CHAR)}function d(a,b,c,e,g,h,i){var k=a[e];if(e<a.length-1){if(c[k]){if("string"==typeof c[k]){if(!h)throw new Error('Token is already declared as a value: "'+token+'"');h.emit(j.NAMESPACE_ALSO_VALUE,token)}}else c[k]={};return d(a,b,c[k],e+1,g,h,i)}if(c[k]&&!g){if(!h)throw new Error('Duplicate token attempted to be added: "'+a.join(i)+'"');h.emit(j.DUPLICATE_TOKEN,a.join(i))}"string"!=typeof b?c[k]=f(m[k]||{},b,g,a.join(i)):c[k]=b}function e(a,b,c,d){var f=a[a.length-1],g=a[d];return c[f]&&(b=c[f]),d<a.length-1&&c[g]?e(a,b,c[g],d+1):b||null}function f(a,b,c,d){var e,g,h={};d=d?d+".":"";for(g in a)h[g]=a[g];for(g in b)if(e=d+g,c||"string"!=typeof b[g]||"string"!=typeof a[g])"object"==typeof b[g]&&b[g]?c&&"string"==typeof b[g]||!a[g]?h[g]=b[g]:h[g]=f(a[g],b[g],c,o,e):h[g]=b[g];else{if(!o)throw new Error('Duplicate token attempted to be added: "'+e+'"');o.emit(j.DUPLICATE_TOKEN,e)}return h}function g(a){var b;return(b=new RegExp("(?:^|; )"+encodeURIComponent(a)+"=([^;]*)").exec(document.cookie))?b[1]:null}function h(a,b){document.cookie=a+"="+b+"; path=/"}function i(a){var b=null;return window.location.href&&(b=new RegExp("[?&]?"+a+"=([^&]*)").exec(window.location.href),b=b?b[1]:null),b}var j={DUPLICATE_TOKEN:"DUPLICATE_TOKEN",NAMESPACE_ALSO_VALUE:"NAMESPACE_ALSO_VALUE"},k={SPLIT_CHAR:".",COOKIE_NAME:"babelbox-locale",URL_PARAM:"locale"},l=k,m={},n=null,o=null;return a.setConfig=function(a){var b={};for(var c in k)b[c]=a[c]||k[c];l=b},a.setEmitter=function(a){if("function"!=typeof a.emit)throw new Error("Emitter requires an emit function in order to be used");o=a},a.reset=function(){l=k,n=a.getLocale(),m={},o=null},a.getLocale=function(){var a=i(l.URL_PARAM);return a=a?a:g(l.COOKIE_NAME),a=a?a:window.navigator.userLanguage||window.navigator.language,a.split("-")},a.setLocale=function(a){h(l.COOKIE_NAME,a.join("-")),n=a},a.getTokens=function(){return m},a.addTokens=function(a){c(a,!1)},a.addExtendedTokens=function(a){c(a,!0)},a.translate=function(a){var c,d=a.match(/(\[\[[^\]]+\]\])/g);if(null===d)return a;for(var e=0;e<d.length;e++)c=b(d[e].substring(2,d[e].length-2)),a=a.replace(d[e],c);return a},a}());